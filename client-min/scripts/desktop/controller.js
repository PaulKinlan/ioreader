// Listen to UI events.
var DesktopController=function(){var a=this,b=0,c=0;$(".categories, .category, article").live("click",function(b){a.activate(b.currentTarget),b.preventDefault();return!1}),window.addEventListener("load",function(a){$("article > header > img.thumbnail[data-src-hi]").each(function(a,b){var c=$(this),d=c.data("src-hi");if(d){var e=new Image;e.onload=function(a){var d=b.cloneNode(!0),e=$(d);d.src=this.src,e.addClass("hi-res"),b.insertAdjacentElement("beforeBegin",d),e.addClass("fadein");var f=function(a){this.addEventListener("webkitTransitionEnd",f,!1),c.remove(),this.style.position="static"};d.addEventListener("webkitTransitionEnd",f,!1)},e.src=d}})}),window.addEventListener("keyup",function(b){var c;switch(b.keyCode){case 37:c=a.getActiveCategory().prev(),c.length==0&&$("section.category").last();break;case 38:c=a.getActiveArticle().prev(),c.length==0&&(c=$("section.active article").last());break;case 39:c=a.getActiveCategory().next(),c.length==0&&(c=$("section.category").first());break;case 40:c=a.getActiveArticle().next(),c.length==0&&(c=$("section.active article").first())}!!c&&c.length>0&&a.activate(c),b.preventDefault();return!1}),window.addEventListener("categorychanged",function(a){var b=$("#"+a.data.category).offset().top;$(".categories").scrollTop(b)})};DesktopController.prototype=new BaseController,DesktopController.prototype.constructor=DesktopController,Controller=new DesktopController